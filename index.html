<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Szkeletal</title> 
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

  <div id="loadingOverlay">
      <div class="loading-container">
          <div id="loadingText" class="loading-text">WCZYTYWANIE ZASOB√ìW...</div>
          <div class="loading-bar-border">
              <div id="loadingBarFill" class="loading-bar-fill"></div>
          </div>
      </div>
  </div>

  <div id="splashOverlay" style="display:none;">
    <img id="splashImage" src="img/splash_dev.png" alt="Ekran powitalny">
  </div>

  <div id="gameContainer">
    <div class="game-view">
        <div id="playerHPBarOuter"><div id="playerHPBarInner"></div><div id="playerHPBarTxt"></div></div>
        <div id="xpBarOuter"><div id="xpBarFill"></div><div id="xpBarTxt"></div></div>
        
        <div id="bonusPanel"></div>

        <canvas id="gameCanvas" width="800" height="600"></canvas>
    </div>
    
    <div id="gameInfo">
      <div class="stat"><span class="stat-icon"><img src="img/icons/hud_score.png" class="stat-icon-img"></span><span id="score">0</span></div>
      <div class="stat"><span class="stat-icon"><img src="img/icons/hud_level.png" class="stat-icon-img"></span><span id="level">1</span></div>
      <div class="stat"><span class="stat-icon"><img src="img/icons/hud_xp.png" class="stat-icon-img"></span><span id="xp">0</span>/<span id="xpNeeded">5</span></div>
      <div class="stat"><span class="stat-icon"><img src="img/icons/hud_health.png" class="stat-icon-img"></span><span id="health">100</span></div>
      
      <div class="stat">
          <span class="stat-icon"><img src="img/icons/hud_enemies.png" class="stat-icon-img"></span>
          <span id="totalKillsSpan">0</span> 
          (<span id="enemyCountSpan">0</span>/<span id="enemyLimitSpan">0</span>)
      </div>
      
      <div class="stat"><span class="stat-icon"><img src="img/icons/hud_time.png" class="stat-icon-img"></span><span id="time">0</span></div>
    </div>
    
    <div id="joystickZone"><div id="joystickBase"></div><div id="joystick"></div></div>
  </div>

  <div id="menuOverlay" class="retro-overlay" style="display:flex;">
    <div class="menu-bg"></div>
    <div class="menu-vignette"></div>

    <div class="retro-frame">
      
      <div id="view-main" class="menu-view active">
        <div class="logo-area">
            <img src="img/logo.png" alt="Szkeletal" class="pixel-logo">
            <div class="version-tag" id="menuVersionTag"></div> 
        </div>
        <div class="menu-list">
            <button id="btnStart" class="retro-btn primary pulse">NOWA GRA</button>
            <button id="btnContinue" class="retro-btn warning" style="display:none;">KONTYNUUJ</button>
            <div class="spacer"></div>
            
            <button id="navScores" class="retro-btn">WYNIKI</button>
            <button id="navConfig" class="retro-btn">OPCJE</button>
            <button id="navGuide" class="retro-btn">PRZEWODNIK</button>
            
            <button id="btnReplayIntroMain" class="retro-btn" onclick="window.wrappedDisplayIntro()">ODTW√ìRZ INTRO</button>
            
            <button id="navCoffee" class="retro-btn" style="border-color:#E91E63; color:#E91E63;">HOT COFFEE ‚òï</button>
            
            <div class="spacer"></div>
            <button id="navDev" class="retro-btn small text-red">DEV TOOLS</button>
        </div>
      </div>

      <div id="view-scores" class="menu-view">
        <h2 id="scoresTitle" class="retro-title">TABLICA WYNIK√ìW</h2>
        <div class="retro-scroll-box">
            <table id="retroScoreTable">
                <thead><tr><th>#</th><th>PKT</th><th>ZAB</th><th>LVL</th><th>CZAS</th></tr></thead>
                <tbody id="scoresBodyMenu"></tbody>
            </table>
            <div id="scoresEmptyMsg" style="text-align:center; color:#666; padding:20px; display:none;">BRAK WYNIK√ìW</div>
        </div>
        <div class="menu-actions">
            <button id="btnClearScoresMenu" class="retro-btn small danger">WYCZY≈öƒÜ</button>
            <button class="retro-btn nav-back">POWR√ìT</button>
        </div>
      </div>

      <div id="view-config" class="menu-view">
        <h2 id="configTitleMain" class="retro-title">KONFIGURACJA</h2>
        <div class="retro-scroll-box config-list">
            <input type="checkbox" id="chkHyper" style="display:none;">
            <input type="checkbox" id="chkShake" checked style="display:none;">
            <input type="checkbox" id="chkFPS" checked style="display:none;">
            <input type="checkbox" id="chkPickupLabels" checked style="display:none;">
            
            <div class="config-row"><span id="lblJoy">JOYSTICK</span><button class="retro-toggle" id="toggleJoy">PRAWA</button></div>
            <div class="config-row"><span id="lblHyper">HYPER MODE</span><button class="retro-toggle off" id="toggleHyper">WY≈Å</button></div>
            <div class="config-row"><span id="lblShake">WSTRZƒÑSY</span><button class="retro-toggle on" id="toggleShake">W≈Å</button></div>
            <div class="config-row"><span id="lblFPS">LICZNIK FPS</span><button class="retro-toggle on" id="toggleFPS">W≈Å</button></div>
            <div class="config-row"><span id="lblLabels">PODPISY</span><button class="retro-toggle on" id="toggleLabels">W≈Å</button></div>
            
            <div class="config-row">
                <span id="lblMusic">MUZYKA</span>
                <input type="range" id="volMusic" class="retro-range" min="0" max="100" value="40">
            </div>
            <div class="config-row">
                <span id="lblSFX">EFEKTY</span>
                <input type="range" id="volSFX" class="retro-range" min="0" max="100" value="30">
            </div>

            <div class="config-row"><span id="lblLang">JƒòZYK</span><div id="lang-selector-container" class="retro-lang-row"></div></div>
        </div>
        <div class="menu-actions"><button class="retro-btn nav-back">POWR√ìT</button></div>
      </div>

      <div id="view-coffee" class="menu-view">
        <h2 id="coffeeTitle" class="retro-title" style="color:#E91E63; border-color:#E91E63;">HOT COFFEE</h2>
        <div class="retro-scroll-box text-center" style="display:flex; flex-direction:column; justify-content:center; align-items:center;">
            <div style="font-size:48px; margin-bottom:15px; width:100%; text-align:center;">‚òï + ü•î</div>
            <p id="coffeeDesc" style="font-size:1.3rem; line-height:1.5; margin-bottom:20px; color:#eee; max-width:90%;">
                Je≈ºeli doceniasz napracowanie...
            </p>
            <div style="display:flex; flex-direction:row; justify-content:center; align-items:center; gap:30px; margin-bottom:20px;">
                <div class="qr-wrapper" style="margin-bottom:0;">
                    <img src="img/qrcode.png" alt="QR Code" style="width:150px; height:150px; display:block; image-rendering:pixelated;">
                </div>
                <img src="img/sink.png" alt="Zlew" style="height:150px; width:auto; display:block; image-rendering:pixelated;">
            </div>
            <a id="coffeeBtn" href="https://suppi.pl/gregor" target="_blank" class="retro-btn primary pulse" style="text-decoration:none; color:#fff; border-color:#E91E63; background:#C2185B;">
                POSTAW KAWKƒò
            </a>
            <div id="coffeeFooter" style="margin-top:20px; opacity:0.6; font-size:0.9rem;">Code by Gregor & Gemini AI</div>
        </div>
        <div class="menu-actions"><button class="retro-btn nav-back">POWR√ìT</button></div>
      </div>

      <div id="view-dev" class="menu-view">
        <h2 id="devTitle" class="retro-title text-red">DEV TOOLS</h2>
        <div class="retro-scroll-box">
            <div class="dev-section">
                <p id="devLblPresets" class="dev-label">PRESETY WROG√ìW (AUTO-START)</p>
                <div class="dev-grid">
                    <button id="devBtnStd" class="retro-btn small" onclick="window.devStartPreset('standard')">STD</button>
                    <button id="devBtnHorde" class="retro-btn small" onclick="window.devStartPreset('horde')">HRD</button>
                    <button id="devBtnRng" class="retro-btn small" onclick="window.devStartPreset('ranged')">RNG</button>
                    <button id="devBtnTank" class="retro-btn small" onclick="window.devStartPreset('tank')">TANK</button>
                    <button id="devBtnSplit" class="retro-btn small" onclick="window.devStartPreset('splitter')">SPLIT</button>
                    <button id="devBtnTroll" class="retro-btn small" onclick="window.devStartPreset('kamikaze')">TROLL</button>
                    <button id="devBtnWall" class="retro-btn small warning" onclick="window.devStartPreset('wall')">WALL</button>
                    <button id="devBtnBoss" class="retro-btn small danger" onclick="window.devStartPreset('elite')">BOSS</button>
                    <button id="devBtnAgr" class="retro-btn small" onclick="window.devStartPreset('aggressive')">AGR</button>
                </div>
            </div>
            <div class="dev-section">
                <p id="devLblScenarios" class="dev-label">SCENARIUSZE</p>
                <div class="dev-grid">
                     <button id="devBtnMin" class="retro-btn small" onclick="window.devStartScenario('min')">MIN</button>
                     <button id="devBtnHigh" class="retro-btn small warning" onclick="window.devStartScenario('high')">HIGH</button>
                     <button id="devBtnMax" class="retro-btn small danger" onclick="window.devStartScenario('max')">MAX</button>
                     <button id="btnDevPeaceful" class="retro-btn small success" onclick="window.devStartPeaceful()">SPACER</button>
                </div>
            </div>
            <div class="dev-section">
                <p id="devLblPlayer" class="dev-label">STAN GRACZA</p>
                <div class="dev-control"><label id="lblDevLvl">Level:</label><input type="number" id="devLevel" min="1" max="100" value="1"></div>
                <div class="dev-control"><label id="lblDevHp">HP:</label><input type="number" id="devHealth" min="1" max="9999" value="100"></div>
                <div class="dev-control"><label id="lblDevXp">XP:</label><input type="number" id="devXP" min="0" max="9999" value="0"></div>
                <div class="dev-control"><label id="lblDevGod">God Mode:</label><input type="checkbox" id="devGodMode" style="width:24px; height:24px;"></div>
                <div class="dev-control"><label id="lblDevHit">Hitboxy:</label><input type="checkbox" id="devDebugHitboxes" style="width:24px; height:24px;"></div>
            </div>
            <div class="dev-section">
                <p class="dev-label">SPAWN ITEM</p>
                <div class="dev-grid">
                    <button class="retro-btn small" onclick="window.devSpawnPickup('heal')">HP</button>
                    <button class="retro-btn small" onclick="window.devSpawnPickup('magnet')">MAG</button>
                    <button class="retro-btn small" onclick="window.devSpawnPickup('shield')">TARCZA</button>
                    <button class="retro-btn small" onclick="window.devSpawnPickup('speed')">SPEED</button>
                    <button class="retro-btn small" onclick="window.devSpawnPickup('bomb')">BOMB</button>
                    <button class="retro-btn small" onclick="window.devSpawnPickup('freeze')">FREEZE</button>
                    <button class="retro-btn small warning" onclick="window.devSpawnPickup('chest')">BOX</button>
                </div>
            </div>
            <div class="dev-section">
                <p class="dev-label">SPAWN WROG√ìW (DOZWOLEMNI)</p>
                <div class="dev-control">
                  <label>Dozwoleni:</label>
                  <select id="devEnemyType" multiple style="background:#333; color:#fff; padding:5px; height:80px;">
                    <option value="all" selected>Wszyscy</option>
                    <option value="standard">Standard</option>
                    <option value="horde">Horda</option>
                    <option value="aggressive">Agresywni</option>
                    <option value="kamikaze">Kamikaze</option>
                    <option value="splitter">Splitter</option>
                    <option value="tank">Tank</option>
                    <option value="ranged">Ranged</option>
                    <option value="wall">Wall</option>
                    <option value="elite">Elite</option>
                  </select>
                </div>
                <div class="dev-control"><label>Rate:</label><input type="number" id="devSpawnRate" step="0.001" value="0.008"></div>
                <div class="dev-control"><label>Max:</label><input type="number" id="devMaxEnemies" value="300"></div>
            </div>
            <button id="btnDevApply" onclick="window.applyDevSettings()" class="retro-btn primary" style="margin-top:10px;">ZASTOSUJ</button>
        </div>
        <div class="menu-actions"><button class="retro-btn nav-back">POWR√ìT</button></div>
      </div>

      <div id="view-guide" class="menu-view">
        <h2 id="guideTitle" class="retro-title">PRZEWODNIK</h2>
        <div id="guideContent" class="retro-scroll-box"></div>
        <div class="menu-actions"><button class="retro-btn nav-back">POWR√ìT</button></div>
      </div>

    </div>
  </div>

  <div id="resumeOverlay" class="retro-overlay" style="display:none; pointer-events:none; background:rgba(0,0,0,0.4);">
      <div class="retro-frame small text-center" style="border:4px solid #FFD700; background:rgba(10, 10, 10, 0.6); box-shadow:0 0 20px #FFD700; width:auto; padding:30px; backdrop-filter:blur(4px);">
          <h2 id="resumeOverlayTitle" style="color:#FFD700; margin:0 0 10px 0; font-size:3rem; letter-spacing:2px;" class="pulse">PRZYGOTUJ SIƒò</h2>
          <div id="resumeText" style="font-size:2rem; color:#fff; text-shadow:1px 1px 0 #000;">Wznawianie...</div>
      </div>
  </div>

  <div id="introOverlay" class="retro-overlay" style="display:none;"> 
    <div class="retro-frame intro-frame"> 
      <div class="intro-image-container"><img id="introImage" class="intro-image" src="" alt="Intro"></div> 
      <div class="intro-controls"> 
        <button id="btnIntroPrev" class="retro-btn small">WSTECZ</button> 
        <button id="btnIntroSkip" class="retro-btn small danger">POMI≈É</button> 
        <button id="btnIntroNext" class="retro-btn small">DALEJ</button> 
      </div> 
    </div> 
  </div>
  
  <div id="levelUpOverlay" class="retro-overlay" style="display:none;"> 
    <div id="levelUpPanel" class="retro-frame wide"> 
      <h2 id="levelUpTitle" class="retro-title">LEVEL UP!</h2> 
      <div id="perks" class="perk-grid"></div> 
      <button id="btnContinueMaxLevel" class="retro-btn warning" style="display:none;">KONTYNUUJ</button> 
      <div class="stats-panel"> 
        <h4 id="levelUpStatsTitle">STATYSTYKI</h4> 
        <div id="statsDisplay" class="stats-grid"></div> 
      </div> 
    </div> 
  </div>
  
  <div id="pauseOverlay" class="retro-overlay" style="display:none; background:rgba(0,0,0,0.7);"> 
    <div class="retro-frame small"> 
      <h2 id="pauseTitle" class="retro-title">PAUZA</h2> 
      <div class="menu-list"> 
        <button id="btnResume" class="retro-btn">WZN√ìW</button> 
        <button id="btnPauseMenu" class="retro-btn warning">MENU</button> 
      </div> 
      <div style="margin-top:20px;"><div id="statsDisplayPause" class="stats-grid"></div></div> 
    </div> 
  </div>
  
  <div id="chestOverlay" class="retro-overlay" style="display:none;"> 
    <div class="retro-frame small text-center"> 
      <h2 id="chestTitle" class="retro-title">SKRZYNIA</h2> 
      <div id="chestRewardDisplay" class="chest-content"></div> 
      <button id="chestButton" class="retro-btn primary pulse">ODBIERZ</button> 
    </div> 
  </div>
  
  <div id="gameOverOverlay" class="retro-overlay" style="display:none;"> 
    <div class="retro-frame"> 
      <h2 id="gameOverTitle" class="retro-title text-red">KONIEC GRY</h2> 
      <div class="gameover-stats" style="font-size:1.3rem; margin-bottom:20px; display:flex; flex-direction:column; align-items:center; gap:5px;"> 
        <p><span id="gameOverScoreLabel">WYNIK:</span> <span id="finalScore" style="color:var(--accent-gold); font-weight:bold;">0</span></p> 
        <p><span id="gameOverLevelLabel">POZIOM:</span> <span id="finalLevel">1</span></p> 
        <p><span id="gameOverTimeLabel">CZAS:</span> <span id="finalTime">0:00</span></p> 
        <p><span id="gameOverKillsLabel">ZABICI:</span> <span id="totalKillsSpanGO">0</span></p> 
      </div> 
      <div class="retro-scroll-box" style="height:150px;"> 
        <table id="goScoreTable"> 
          <tbody id="scoresBodyGameOver"></tbody> 
          <thead><tr><th>#</th><th>PKT</th><th>ZAB</th><th>LVL</th><th>CZAS</th></tr></thead> 
        </table> 
      </div> 
      <button id="btnClearScoresGO" class="retro-btn small danger" style="margin-bottom:10px;">WYCZY≈öƒÜ</button> 
      <div class="menu-actions"> 
        <button id="btnRetry" class="retro-btn primary">JESZCZE RAZ</button> 
        <button id="btnMenu" class="retro-btn">MENU</button> 
      </div> 
    </div> 
  </div>

  <div id="confirmOverlay" class="retro-overlay" style="display:none;"> 
    <div class="retro-frame small text-center"> 
      <h2 id="confirmTitle" class="retro-title">POTWIERD≈π</h2> 
      <p id="confirmText">Czy wyczy≈õciƒá wyniki?</p> 
      <div class="menu-actions"> 
        <button id="btnConfirmYes" class="retro-btn danger">TAK</button> 
        <button id="btnConfirmNo" class="retro-btn">NIE</button> 
      </div> 
    </div> 
  </div>

  <script type="module" src="js/main.js"></script>
  <script>
    function menuNav(viewId) {
        document.querySelectorAll('.menu-view').forEach(el => el.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
        if(viewId === 'view-scores' && window.wrappedDisplayScores) window.wrappedDisplayScores();
        if(viewId === 'view-guide' && window.wrappedGenerateGuide) window.wrappedGenerateGuide();
    }
    
    document.getElementById('navScores').onclick = () => menuNav('view-scores');
    document.getElementById('navConfig').onclick = () => menuNav('view-config');
    document.getElementById('navGuide').onclick = () => menuNav('view-guide');
    document.getElementById('navCoffee').onclick = () => menuNav('view-coffee');
    document.getElementById('navDev').onclick = () => menuNav('view-dev');
    document.querySelectorAll('.nav-back').forEach(b => b.onclick = () => menuNav('view-main'));
  </script>
</body>
</html>